# Журнал изменений

## 1.0.4 — 15.02.2026

### Документы / OnlyOffice
- Интегрирован OnlyOffice Document Server в отдельном контейнере с reverse-proxy через `/office/`.
- Добавлены backend endpoint'ы для OnlyOffice:
  - `GET /api/docs/{id}/office/config`
  - `GET /api/docs/{id}/office/file`
  - `POST /api/docs/{id}/office/callback`
  - `POST /api/docs/{id}/office/forcesave`
- Реализованы JWT-подписи и серверные проверки (zero-trust) для конфигурации, бинарной выдачи и callback.
- Для DOCX включен встроенный OnlyOffice в панели документа (без внешних CDN).
- Для PDF/DOCX отключены markdown-элементы в модальном редакторе.

### Сохранение и версии DOCX
- Версионирование DOCX выполняется только через явное сохранение SCC (кнопка `Сохранить` в модальном окне + причина изменения).
- Callback сохраняет новую версию только для explicit-save потока; in-editor save/`Ctrl+S` не создают версию SCC.
- Добавлена защита от ложного «успешно сохранено»: успех показывается только если появилась новая версия.

### Надежность и UX
- Исправлены переходы `Просмотр <-> Редактирование` для DOCX (полный re-init сессии).
- Для каждого открытия выдаётся уникальный session key OnlyOffice с валидным charset (hex), чтобы избежать websocket/session reject.
- Снижен шум в аудите: внутренние технические обновления контента выполняются с `?audit=0`.
- Добавлены/исправлены RU/EN i18n-ключи для статусов и ошибок OnlyOffice.
- Исправлено переполнение длинных названий документов и выравнивание кнопок в UI.

### Безопасность
- В конфиге редактора отключены `download` и `print` permissions для DOCX.
- Сервер продолжает проверять права на каждом endpoint (UI не является контролем безопасности).
- Добавлены аудит-события для действий OnlyOffice (`config`, `forcesave`, `callback_saved`, `callback_error`).

## 1.0.3 — 13.02.2026
- Базовый релиз платформы с модулями backup/SLA/monitoring и обновлённой серверной архитектурой.
